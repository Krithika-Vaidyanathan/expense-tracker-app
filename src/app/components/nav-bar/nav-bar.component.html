<!-- src/app/components/nav-bar/nav-bar.component.html -->
<nav
  class="flex justify-between items-center w-full px-4 sm:px-6 py-3 bg-white shadow-sm border-b border-gray-100 sticky top-0 z-50">

  <!-- Logo Section -->
  <div (click)="goHome()" class="logo cursor-pointer flex items-center gap-x-3">
    <img
      class="object-contain w-28 sm:w-32 md:w-[12.2rem] h-auto max-w-[12.2rem]"
      src="assets/wealthyway-logo.png"
      alt="WealthyWay Logo"
    />
  </div>

  <!-- Right Section -->
  <div class="flex items-center gap-4" *ngIf="!isAuthPage && user">

    <!-- Greeting (desktop only) -->
    <p class="hidden sm:block text-base md:text-lg text-gray-700 font-medium">
      Hi,
      <span class="text-customHsl-accent font-semibold">
        {{ user.user_metadata.name || user.email }}
      </span> ðŸ‘‹
    </p>

    <!-- UNIVERSAL SNACKBAR MENU ICON -->
    <div class="relative">

      <!-- Snackbar Icon -->
      <button (click)="showMenu = !showMenu"
        class="w-10 h-10 bg-customHsl-accent hover:brightness-110 text-white rounded-md shadow-sm 
               transition flex justify-center items-center">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" stroke-width="2"
          stroke-linecap="round" stroke-linejoin="round" class="w-6 h-6">
          <line x1="3" y1="6" x2="21" y2="6" />
          <line x1="3" y1="12" x2="21" y2="12" />
          <line x1="3" y1="18" x2="21" y2="18" />
        </svg>
      </button>

      <!-- CLICK OUTSIDE OVERLAY -->
      <div *ngIf="showMenu"
        (click)="showMenu = false"
        class="fixed inset-0 z-40 bg-black/20">
      </div>

      <!-- DROPDOWN MENU -->
      <div *ngIf="showMenu"
        class="absolute right-0 mt-2 w-52 bg-white shadow-xl rounded-lg border py-2 z-50 animate-fadeIn">

        <!-- SUBMIT FEEDBACK -->
        <button (click)="openFeedbackModal(); showMenu = false"
          class="w-full text-left px-4 py-2 text-sm flex items-center justify-between hover:bg-gray-100 text-black">

          <span class="flex items-center gap-2">
            Submit Feedback
          </span>

          <!-- Feedback Icon -->
          <img 
            src="https://cdn-icons-png.flaticon.com/512/2462/2462719.png"
            alt="Feedback Icon"
            class="w-5 h-5 object-contain"
          />
        </button>

        <!-- LOGOUT -->
        <button (click)="logout(); showMenu = false"
          class="w-full text-left px-4 py-2 text-sm flex items-center justify-between hover:bg-gray-100">

          <span class="flex items-center gap-2">
            Logout
          </span>

          <!-- Logout Icon -->
          <img 
            src="https://cdn-icons-png.flaticon.com/512/5509/5509651.png"
            alt="Logout Icon"
            class="w-5 h-5 object-contain"
          />
        </button>

        <!-- DELETE ACCOUNT -->
        <button (click)="confirmDeleteUser(); showMenu = false"
          class="w-full text-left px-4 py-2 text-sm flex items-center justify-between text-red-600 hover:bg-gray-100">

          <span class="flex items-center gap-2">
            Delete Account
          </span>

          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"
            width="18" height="18">
            <path fill-rule="evenodd" clip-rule="evenodd"
              d="M16.5 4.478v.227a48.816 48.816 0 013.878.512.75.75 
                 0 11-.256 1.478l-.209-.035-1.005 13.07a3 3 
                 0 01-2.991 2.77H8.084a3 3 0 01-2.991-2.77L4.087 
                 6.66l-.209.035a.75.75 0 01-.256-1.478A48.567 
                 48.567 0 017.5 4.705v-.227c0-1.564 1.213-2.9 
                 2.816-2.951a52.662 52.662 0 013.369 0c1.603.051 
                 2.815 1.387 2.815 2.951z" />
          </svg>

        </button>

      </div>
    </div>

  </div>
</nav>

<!-- Popup -->
<app-popup 
  [visible]="showDeletePopup"
  [message]="deletePopupMessage"
  [confirmMode]="true"
  (confirm)="deleteUserPermanently()"
  (close)="showDeletePopup = false">
</app-popup>

<!-- FEEDBACK DIALOG COMPONENT (ALWAYS KEEP AT ROOT LEVEL) -->
<app-feedback-dialog
  [visible]="showFeedbackModal"
  (close)="showFeedbackModal = false">
</app-feedback-dialog>

<style>
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(-4px); }
    to   { opacity: 1; transform: translateY(0); }
  }
  .animate-fadeIn {
    animation: fadeIn 0.15s ease-out;
  }
</style>
